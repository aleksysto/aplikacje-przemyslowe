<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5">
<div th:replace="~{fragments/header :: header}"></div>
<h2 class="text-center mb-4">Admin Dashboard</h2>

<div class="d-flex justify-content-between mb-4">
    <a href="/admin/books/add" class="btn btn-primary">Add Book</a>
    <a href="/admin/authors/add" class="btn btn-secondary">Add Author</a>
</div>

<div class="mb-3">
    <label for="entitySelect" class="form-label">Show:</label>
    <select id="entitySelect" class="form-select" onchange="showEntityList()">
        <option value="books">Books</option>
        <option value="authors">Authors</option>
        <option value="users">Users</option>
        <option value="comments">Comments</option>
    </select>
</div>

<div id="booksList" class="border p-3 rounded shadow-sm">
    <h3>Books</h3>
    <ul class="list-group">
        <li class="list-group-item d-flex justify-content-between align-items-center" th:each="book : ${books}">
            <span th:text="${book.title} + ' by ' + ${book.author.name}"></span>
            <div>
                <a th:href="@{/admin/books/edit/{bookId}(bookId=${book.id})}" class="btn btn-sm btn-warning">Edit</a>
                <form method="post" th:action="@{/admin/books/delete/{bookId}(bookId=${book.id})}" class="d-inline">
                    <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                </form>
            </div>
        </li>
    </ul>
</div>

<div id="authorsList" class="border p-3 rounded shadow-sm d-none">
    <h3>Authors</h3>
    <ul class="list-group">
        <li class="list-group-item d-flex justify-content-between align-items-center" th:each="author : ${authors}">
            <span th:text="${author.name}"></span>
            <div>
                <a th:href="@{/admin/authors/edit/{authorId}(authorId=${author.id})}" class="btn btn-sm btn-warning">Edit</a>
                <form method="post" th:action="@{/admin/authors/delete/{authorId}(authorId=${author.id})}" class="d-inline">
                    <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                </form>
            </div>
        </li>
    </ul>
</div>

<div id="usersList" class="border p-3 rounded shadow-sm d-none">
    <h3>Users</h3>
    <ul class="list-group">
        <li class="list-group-item d-flex justify-content-between align-items-center" th:each="user : ${users}">
            <span th:text="${user.username}"></span>
            <form method="post" th:action="@{/admin/users/delete/{userId}(userId=${user.id})}" class="d-inline">
                <button type="submit" class="btn btn-sm btn-danger">Delete</button>
            </form>
        </li>
    </ul>
</div>

<div id="commentsList" class="border p-3 rounded shadow-sm d-none">
    <h3>Comments</h3>
    <ul class="list-group">
        <li class="list-group-item d-flex justify-content-between align-items-center" th:each="comment : ${comments}">
            <span th:text="${comment.text} + ' - ' + ${comment.author.username}"></span>
            <div>
                <a th:href="@{/admin/comments/edit/{commentId}(commentId=${comment.id})}" class="btn btn-sm btn-warning">Edit</a>
                <form method="post" th:action="@{/admin/comments/delete/{commentId}(commentId=${comment.id})}" class="d-inline">
                    <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                </form>
            </div>
        </li>
    </ul>
</div>

<p class="mt-4"><a href="/" class="btn btn-outline-secondary">Back to Home</a></p>

<script>
    function showEntityList() {
        document.getElementById("booksList").classList.add("d-none");
        document.getElementById("authorsList").classList.add("d-none");
        document.getElementById("usersList").classList.add("d-none");
        document.getElementById("commentsList").classList.add("d-none");

        let selected = document.getElementById("entitySelect").value;
        document.getElementById(selected + "List").classList.remove("d-none");
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
